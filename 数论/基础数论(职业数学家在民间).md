# 基础数论第一课：裴蜀引理

### 预备知识

+ **约数**和**倍数**：如果一个整数 $a$ 能被**正整数** $b$ 整除，也就是说存在另一个整数 $p$ 使得 $a=b \times p$ 或者 $\frac{a}{b}=p$，那么我们就称 $b$ 是 $a$ 的约数或因数，$a$ 是 $b$ 的倍数。

+ 正整数 $a$ 的两个倍数的**和或差**还是 $a$ 的倍数。

+ **公约数**和**最大公约数**：如果**正整数** $p$ 同时是两个整数 $a,b$ 的约数，我们就称 $p$ 为 $a$ 和 $b$ 的公约数。$a$ 和 $b$ 的所有公约数中最大的那个数称为 $a$ 和 $b$ 的最大公约数。记作 $(a,b)$ 

+ **带余除法**：给定一个整数 $a$ 和 一个正整数 $q$，总能找到一个整数 $b$ 使得 $a=b \times q+r$，其中 $0 \leq r < q$。我们称 $r$ 为 $a$ 被 $q$ 除的余数。

### 裴蜀引理

+ 给定两个整数 $a$ 和 $b$，假定他们的最大公约数是 $p$，那么方程 $ax + by = n$ 有整数解 $(x,y)$ 当且仅当 $n$ 是 $p$ 的倍数。

### 两个重要推论

+ **素数**和**互素**：一个大于 $1$ 的正整数，如果有只有 $1$ 和它本身两个约数，就称它为素数。两个整数的最大公约数如果为 $1$，就称这两个数是互素的。

+ 推论一：两个整数 $a$ 和 $b$ 互素，当且仅当 $ax+by=1$ 有整数解。

+ 推论二：如果素数 $p$ 整除两个整数 $a$ 和 $b$ 的乘积 $ab$，则 $p$ 必然会整除 $a$ 或 $b$。

---

# 基础数论第二课：辗转相除法

+ 辗转相除法求最大公约数

+ 辗转相除法可以求解 方程 $ax+by=n$

---

# 基础数论第三课：算术基本定理

+ 算术基本定理告诉我们，如果不考虑排列次序的话，每个大于 $1$ 的自然数都只能有一种方式分解成若干个素数的乘积。
  
  - 存在性
  
  - 唯一性
  
  $$
  a = p_1^{s_1}p_2^{s_2} \cdots p_n^{s_n} \\
  $$

### 最大公约数和最小公倍数的分解形式

+ **公倍数**和**最小公倍数**：如果正整数 $n$ 同时是两个整数 $a,b$ 的倍数，我们就称 $n$ 为 $a$ 和 $b$ 的公倍数。$a$ 和 $b$ 的所有公倍数中最小的那个数称为 $a$ 和 $b$ 的最小公倍数。记作 $[a,b]$

$$
\begin{aligned}
a &= p_1^{s_1}p_2^{s_2} \cdots p_n^{s_n} \\ 
b &= p_1^{t_1}p_2^{t_2} \cdots p_n^{t_n} \\
(a,b)&=p_1^{min(s_1,t_1)}p_2^{min(s_2,t_2)} \cdots p_n^{min(s_n,t_n)} \\
[a,b]&=p_1^{max(s_1,t_1)}p_2^{max(s_2,t_2)} \cdots p_n^{max(s_n,t_n)} \\
ab&=(a,b)[a,b]
\end{aligned}
$$

---

# 基础数论第四课：素数的基本性质和未解之谜

+ 有无限个素数

+ **(Dirichet)** 给定两个正整数 $a,b$，满足 $(a,b)=1$，则存在无穷多个 $an+b$ 型的素数

+ **(Bertrand)** $n>3$ 时，在 $n$ 和 $2n$ 之间一定有至少一个素数

+ **(素数定理)** 令小于正整数 $x$ 的素数的个数为 $\pi(x)$，那么 $x$ 趋于无穷时 $\pi(x) \sim \frac{x}{ln_{}{x}}$

### 素数未解之迷

+ $n^2 + 1$ 型的素数有无限多个

+ 在 $n^2$ 和 $(n+1)^2$ 之间总存在素数

+ **(哥德巴赫猜想)** 每个大于4的偶数都可以写成两个奇素数之和

+ (孪生素数猜想) 存在无穷多对形如 $p, p+2$ 的素数

+ 斐波拉契数列 $1,1,2,3,5,8,13,\cdots$ 中存在无穷多个素数

+ (梅森素数猜想) 存在无穷多个形如 $2^n - 1$ 的素数

---

# 基础数论第五课：同余理论

+ **同余**：如果正整数 $m$ 整除两个整数 $a,b$ 的差，或者说 $m$ 是 $a-b$ 的一个约数，我们就称 $a$ 和 $b$ (关于模 $m$)同余。记住 $a \equiv b \pmod m$

同余的基本性质（模 $m$）

+ $a \equiv a$

+ 若 $a \equiv b$，则 $b \equiv a$

+ 若 $a \equiv b, ~~ b \equiv c$，则 $a \equiv c$

+ 若 $a \equiv b, ~~ a^{'} \equiv b^{'}$ 则：$a + a^{'} \equiv b + b^{'}, ~~ a \cdot a^{'} \equiv b \cdot b^{'}$

### 剩余类（模 $m$）

+ 和一个固定整数 $a$ 同余的所有整数构成的集合称为一个**剩余类**，记作$\bar{a}$

+ 带余除法表明共有 $m$ 个剩余类

+ 两个剩余类 $\bar{a},\bar{b}$ 的和 $\bar{a}+\bar{b}$ 定义为 $\overline{a+b}$，乘积 $\bar{a} \times \bar{b}$ 定义为 $\overline{ab}$

### 同余方程

+ 同余方程是指形如 $f(x) \equiv g(x) \pmod{m}$，其中 $f$ 是整系数多项式。同余方程的解是（模 $m$）剩余类

---

# 基础数论第六课：剩余类环和剩余类域

### 剩余类环

+ 所有的整数构成的集合（记作 $\mathbb{Z}$），具有下面三个特性，称为整数环
  
  - 有加法乘法两种运算，满足**交换律**、**结合律**、**分配律**
  
  - 有唯一的 $0$ 元素和 $1$ 元素，所有整数加上 $0$ （乘上 $1$）保持不变
  
  - 任何元素 $n$ 都有相反元素 $-n$，使得 $n+(-n) = 0$

> **环**是一种代数结构，包含两个二元运算（加法和乘法），满足以下条件：
> 
> 1. **加法**构成阿贝尔群（交换群），即满足封闭性、结合律、存在单位元（零元）、每个元素有逆元（负元）以及交换律。
> 
> 2. **乘法**构成半群（封闭且满足结合律）。
> 
> 3. **乘法对加法满足分配律**，即对于所有元素 $a,b,c$，有 $a(b+c)=ab+ac$ 和 $(a+b)c=ac+bc$。
> 
> 与群的区别主要体现在以下几个方面：
> 
> 1. **运算数量**：群只有一个二元运算，而环有两个二元运算（加法和乘法）。
> 
> 2. **加法结构**：环的加法必须是阿贝尔群，而群的运算不一定是交换的（除非是阿贝尔群）。
> 
> 3. **乘法结构**：环的乘法不需要有单位元或逆元，而群中的每个元素必须对唯一运算有逆元。
> 
> 4. **分配律**：环要求乘法对加法满足分配律，而群没有分配律的概念。
> 
> 总结：
> 
> - **环**：两个运算（加法与乘法），加法为阿贝尔群，乘法为半群且对加法分配。
> 
> - **群**：一个运算，所有元素有逆元，运算不一定交换。

+ $m$ 个剩余类（模 $m$）构成的环，称为模 $m$ 剩余类环，记作 $\mathbb{Z}/m$

+ 同余方程和剩余类环 $\mathbb{Z}/m$ 上的方程是等价的
  
  - $ax \equiv b \pmod m  \Leftrightarrow \bar{a}x = \bar{b}$
  
  - $x^2 - x - 1 \equiv 0 \pmod m  \Leftrightarrow x^2 - x - \bar{1} = \bar{0}$

### 剩余类域

+ 所有的有理数构成集合（记作 $\mathbb{Q}$），也具有下面三个特征（环的特）
  
  - 有加法乘法两种运算，满足**交换律**、**结合律**、**分配律**
  
  - 有唯一的 $0$ 元素和 $1$ 元素，所有整数加上 $0$ （乘上 $1$）保持不变
  
  - 任何元素 $n$ 都有相反元素 $-n$，使得 $n+(-n) = 0$
  
  但是有理数集合 $\mathbb{Q}$ 还多了一个性质，称为有理数域
  
  - 认为非零元素 $n$ 都有逆元素 $n^{-1}$，使得 $n \cdot n^{-1} = 1$

+ 定理：剩余类环 $\mathbb{Z}/m$ 是一个域，当且仅当 $m$ 为素数
  
  - $p$ 为素数时，称 $\mathbb{Z}/p$ 为**剩余类域**

---

# 基础数论第七课：欧拉定理和费马小定理

+ 思考：剩余类环 $\mathbb{Z}/m$ 中那些元素有逆元素
  
  - 结论：$\bar{a}$ 在剩余类环 $\mathbb{Z}/m$ 中有逆元素（有可逆元），当且仅当 $(a,m)=1$

+ $\mathbb{Z}/m$ 中可逆元的个数记作 $\phi(m)$，这个函数称为欧拉函数

+ 欧拉函数 $\phi(m)$ 就是 $1$ 到 $m$ 之间与 $m$ 互素的整数的个数
  
  - $p$ 为素数时，$\phi(p)= p -1$

+ 欧拉定理：如果 $(a,m)=1$，那么在剩余类环 $\mathbb{Z}/m$ 中，$\bar{a}^{\phi(m)} = \bar{1}$。用同余的符号就是 $a^{\phi(m)} \equiv 1 \pmod m$

+ 费马小定理：如果 $a$ 不能被素数 $p$ 整除，那么 $a^{p - 1} \equiv 1 \pmod p$

---

# 基础数论第八课：中国剩余定理

### 预备知识

+ 如果 $m_1, m_2, \cdots, m_n$ 都和 $m$ 互素，那么 $m_1m_2 \cdots m_n$ 也和 $m$ 互素

+ 如果两两互素的正整数 $m_1,m_2,\cdots, m_n$ 都能整除 $a$，那么他们的乘积 $m_1m_2 \cdots m_n$ 也能整除 $a$

### 中国剩余定理

如果 $m_1, m_2, \cdots, m_n$ 是两两互素的正整数，那么同余方程组

$$
\begin{aligned}
x & \equiv a_1 \pmod {m_1} \\
x & \equiv a_2 \pmod {m_2} \\
& \qquad \vdots \\
x & \equiv a_n \pmod {m_n} \\
\end{aligned}
$$

有唯一一个满足 $0 \le x < m_1 m_2, \cdots, m_n$ 的解。

### 欧拉函数的基本性质

+ 若 $(m,n)=1$， 则 $\phi(m) \phi(n) = \phi(mn)$

+ $\phi(p^k) = p^k - p^{k-1}$

+ 定理：若 $m=p_1^{k_1}p_2^{k_2} \cdots p_n^{k_n}$ 为标准的素数分解，则
  
  $$
  \phi(m) = m(1 - \frac{1}{p_1})(1 - \frac{1}{p_2}) \cdots (1- \frac{1}{p_n})
  $$

---

# 基础数论第九课：二次剩余

+ 已知 $x^2 \equiv a \pmod p$，$p$ 是奇素数，$(a,p) = 1$。若该同余方程有解，则称 $a$ 为 $\pmod p$ **二次剩余**，若该同余方程无解，则称 $a$ 为 $\pmod p$ **二次非剩余**。

+ 二次剩余和二次剩余的乘积还是二次剩余

+ 二次剩余和二次非剩余的乘积是二次非剩余

+ 二次非剩余和二次非剩余的乘积是二次剩余

+ $1,2,\cdots, p-1$ 中有 $\frac{p-1}{2}$ 个二次剩余和 $\frac{p-1}{2}$ 个二次非剩余

### 预备知识

+ $a$ 为二次非剩余，$(p-1)! \equiv a^{\frac{p-1}{2}} \pmod p$

+ $a$ 为二次剩余，$(p-1)! \equiv -a^{\frac{p-1}{2}} \pmod p$

### 勒让德符号

+ 引入一种符号，$\Big( \frac{a}{p} \Big)$，$p$ 为奇素数，$(a,p)=1$
  
  - 如果 $a$ 为$\pmod p$ 二次剩余，$\Big( \frac{a}{p} \Big)=1$
  
  - 如果 $a$ 为$\pmod p$ 二次非剩余，$\Big( \frac{a}{p} \Big)=-1$

+ 定理：$(p-1)! \equiv - \Big( \frac{a}{p} \Big) a^{\frac{p-1}{2}} \pmod p$

+ **威尔逊定理**：$(p-1)! \equiv -1 \pmod p$

+ 推论一：$\Big( \frac{a}{p} \Big) \equiv a^{\frac{p-1}{2}} \pmod p$

+ 推论二：$\Big( \frac{-1}{p} \Big) = (-1)^{\frac{p-1}{2}}$
  
  - $p$ 为 $4n+1$ 型时，$-1$ 是二次剩余；$p$ 为 $4n+3$ 型时，$-1$ 时二次非剩余

+ 推论三：若 $a,b$ 是两个互素的正整数，则 $a^2 + b^2$ 的 素因子都是 $4n+1$ 型的

---

# 数论课程第十课：高斯引理

+ 对于任何整数 $a$, 都有 $-\frac{p}{2}$ 和 $\frac{p}{2}$ 之间唯一的一个数 $\pmod p$ 同余，称为 $a$ 的 $\pmod p$ 最小剩余

+ $m, 2m, \cdots, \frac{p-1}{2}m$ 的最小剩余为 $-a_1, -a_2, \cdots, -a_{\mu}, a_{\mu+1}, \cdots, a_{\frac{p-1}{2}}$

+ 高斯引理：$\Big( \frac{m}{p} \Big) = (-1)^{\mu}$

---

# 数论课程第十一课：二次互反律

+ **二次互反律**：$p,q$ 是两个不同的奇素数，令 $p^{'} = \frac{p-1}{2}, q^{'}=\frac{q-1}{2}$，则 $\Big( \frac{p}{q} \Big) \Big( \frac{q}{p} \Big) = (-1)^{p^{'}q^{'}}$

---

# 数论课程第十二课：算术函数

+ **算术函数**：定义在正整数集合上的函数
  
  - 例如：$f(n) = n+1, f(n) = n^2+1，(n \in \mathbb{N})$
  
  - 例如：对于正整数 $n$，令 $\sigma(n)$ 为所有 $n$ 的约数的和，$\nu(n)$ 为 $n$ 约数的个数

+ **莫比乌斯函数**：定义
  
  $$
  \mu(n) = 
\begin{cases}
1 & n = 1; \\
0 & n = p_1^{k_1}p_2^{k_2}\cdots p_s^{k_s}, (\exists ~k \in \{k_1, k_2, \cdots, k_s\}, k \ge 2); \quad //含有平方因子 \\
(-1)^s & n = p_1p_2\cdots p_s; \quad //s为不同素因子个数
\end{cases}
  $$

+ 则有 $n > 1$ 时，$\sum_{d \mid n}{}\mu(d) = 0$（对 $n$ 的每一个因子做遍历，计算**莫比乌斯函数**，**和**为 $0$）。$n=0$ 时，$\sum_{d \mid n}{}\mu(d) = 1$。

+ 算术函数之间的**Dirichlet乘积**定义：
  
  $$
  \begin{aligned}
f \circ g(n) &= \sum_{d_1 d_2 = n} f(d_1) \times g(d_2) \\
&= \sum_{d \mid n} f(d) \times g(\frac{n}{d})
\end{aligned}
  $$

+ 定义 $\mathrm{II}$ 函数：
  
  $$
  \mathrm{II}(n)=
\begin{cases}
1, & n = 1 \\
0, & n > 1 \\
\end{cases}
  $$
  
  - 对于任意 $f$ 有
    
    $$
    \begin{aligned}
f \circ \mathrm{II} (n) &= \sum_{d \mid n} f(d) \times \mathrm{II}(\frac{n}{d}) \\
&= f(n)
\end{aligned}
    $$

+ 定义 $\mathrm{I}$ 函数：$\mathrm{I}(n) = 1$
  
  + 令 $f = \mu$， 则
    
    $$
    \begin{aligned}
\mu \circ \mathrm{I}(n) &= f \circ \mathrm{I}(n) = \sum_{d \mid n} f(d) \times \mathrm{I}(\frac{n}{d}) \\
&=
\begin{cases}
\mu(1) \times 1 = 1, & n=1 \\
\sum_{d \mid n}{}\mu(d) \times 1 = 0, & n=0 \\
\end{cases} \\
&= \mathrm{II}(n)
\end{aligned}
    $$

+ 莫比乌斯反演：若 $g(n) = \sum_{d \mid n} f(d)$，那么有 $f(n) = \sum_{d \mid n} \mu(d) \times g(\frac{n}{d})$。$g(n)$ 称为 $f(n)$  的莫比乌斯变换。
  
  $$
  \begin{aligned}
g &= \mathrm{I} \circ f \\
u \circ g &= u \circ \mathrm{I} \circ f \\
&= \mathrm{II} \circ f \\
&= f \\
\Rightarrow f &= u \circ g \\
&= \sum_{d \mid n} \mu(d) \times g(\frac{n}{d})
\end{aligned}
  $$

+ $\sum_{d \mid n}{} \phi(d) = n$

+ 通过莫比乌斯反演得到 $\phi(n) = \sum_{d \mid n}{} \mu(d) \frac{n}{d}$

---

# 基础数论第十三课：剩余类域上的多项式

+ 定理：剩余类域 $\mathbb{Z}/p$ 上 $n$ 次多项式最多只有 $n$ 个根
  
  - $x^n + a_1x^{n-1} + \cdots + a_{n-1}x + a_n \equiv 0 \pmod n$
  
  - 它的根是同余类
  
  - 如果 $d$ 整除 $p-1$，那么 $x^d \equiv 1 \pmod p$ 刚好有 $d$ 个解

+ **威尔逊定理**：$(p - 1)! \equiv -1 \pmod p$

+ 满足同余式 $a^n \equiv 1 \pmod m$ 的最小正整数 $n$，称为 $a$ 模 $m$ 的阶，记作 $\delta_m(a)$
  
  - $\bar{a} = \bar{1}, \bar{a}^2, \cdots, \bar{a}^n, \bar{a}^{n+1} = \bar{1}$，意义是出现周期循环的最小次幂

+ 若 $(a,m) =1$，且 $\delta_m(a) = \phi(a)$，则称 $a$ 为模 $m$ 的原根

+ 定理：$1$ 到 $p-1$ 中原根的个数为 $\phi(p-1)$

---

[1] [基础数论-职业数学家在民间-B站](https://space.bilibili.com/513362187)

---
